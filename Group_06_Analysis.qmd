---
title: "Group_06_Analysis"
author: "Group 06"
number-sections: true
format: 
  html:
    embed-resources: true
    code-tools: true
  pdf: 
   geometry: "left=2cm, right=2cm, top=2cm, bottom=2cm"
editor_options: 
  chunk_output_type: console
execute:
  echo: false
  eval: true
  warning: false
  message: false
---

```{r}
#| label: libraries
library(ggplot2)
library(tidyverse)
library(gt)
library(patchwork)
library(gridExtra)
library(moderndive)
library(MASS)
library(knitr)
library(GGally)
library(skimr)
```

# Introduction {#sec-Intro}

```{r}
# Import the data sets
imdb_data <- read.csv("dataset06.csv")
glimpse(imdb_data)
```

# Data Wrangling Methods {#sec-DW}
Before we begin the analysis of our data, let's transform the data using various tools.The process below describes the detailed data wrangling techniques that are used to get the desired data set.
```{r}
# Since genre is of type character, we convert it to factor
imdb_data$genre <- as.factor(imdb_data$genre)
```

As per the research question, 'rating' is converted to a binary variable taking 1 or 0 values.
```{r}
#new binary column#
imdb_data$high_rating <- ifelse(imdb_data$rating >= 7, 1, 0)
```

A check for missing values was conducted and it was found that 103 observation were missing from the column length. Impute missing values with the median since median is a robust measure i.e not impacted by outliers as much as mean
```{r}
# Check for missing values
missing_values <- sum(is.na(imdb_data$length)) #103 values
colSums(is.na(imdb_data)) #103 observations are missing in 'length'

# Impute missing values with the median since median is a robust measure i.e not impacted by outliers as much as mean
median_length_by_genre <- imdb_data %>%
  group_by(genre) %>%
  summarize(median_length = median(length, na.rm = TRUE))

median_length_by_genre
for (i in 1:nrow(median_length_by_genre)) {
  genre <- median_length_by_genre$genre[i]
  median_length <- median_length_by_genre$median_length[i]
  imdb_data$length[imdb_data$genre == genre & is.na(imdb_data$length)] <- median_length
}
```

# Exploratory Data Analysis {#sec-EDA}

Let's have a look at the first five rows of the data frame
```{r}
imdb_data |>
  slice_head(n=5) |>
  gt() |>
  fmt_number(decimals=2)
```
## Summary Statistics {#sec-sum}

```{r}

summary_year <- imdb_data %>%
  summarise('Mean' = mean(year),
            'Median' = median(year),
            'St.Dev' = sd(year),
            'Min' = min(year),
            'Max' = max(year),
            'IQR' = quantile(year,0.75)-quantile(year,0.25),
            'Sample_size' = n())
summary_length <- imdb_data %>%
  summarise('Mean' = mean(length),
            'Median' = median(length),
            'St.Dev' = sd(length),
            'Min' = min(length),
            'Max' = max(length),
            'IQR' = quantile(length,0.75)-quantile(length,0.25),
            'Sample_size' = n())
summary_budget <- imdb_data %>%
  summarise('Mean' = mean(budget),
            'Median' = median(budget),
            'St.Dev' = sd(budget),
            'Min' = min(budget),
            'Max' = max(budget),
            'IQR' = quantile(budget,0.75)-quantile(budget,0.25),
            'Sample_size' = n())
summary_votes <- imdb_data %>%
  summarise('Mean' = mean(votes),
            'Median' = median(votes),
            'St.Dev' = sd(votes),
            'Min' = min(votes),
            'Max' = max(votes),
            'IQR' = quantile(votes,0.75)-quantile(votes,0.25),
            'Sample_size' = n())
combined_summary <- bind_rows(summary_year, summary_length, summary_budget, summary_votes)

combined_summary |>
  gt() |>
  fmt_number(decimals=2) |>
  cols_label(
    Mean = html("Mean"),
    Median = html("Median"),
    St.Dev = html("Std. Dev"),
    Min = html("Minimum"),
    Max = html("Maximum"),
    IQR = html("Interquartile Range"),
    Sample_size = html("Sample Size")
  ) 
```
```

## Correlation {#sec-cor}
Scatter plot Matrix shows very low correlation between continuous variables
```{r}
#| label: fig-plot1
#| fig-cap: scatterplot matrix with ggpairs
#| fig-align: center
#| message: false
scatterplot_matrix <- ggpairs(imdb_data[, c("year", "budget", "rating", "length", "votes")], 
                              title="Scatterplot matrix")
scatterplot_matrix
```

## Visualization {#sec-viz}
Histograms to understand the data structures of different variables

```{r}
#DATA STRUCTURES#
#Histograms for statistical distribution#
year_plot <- ggplot(data=imdb_data, mapping=aes(x=year))+
  geom_histogram(color="red")

length_plot <- ggplot(data=imdb_data, mapping=aes(x=length))+
  geom_histogram(color="blue")

budget_plot <- ggplot(data=imdb_data, mapping=aes(x=budget))+
  geom_histogram(color="green")

votes_plot <- ggplot(data=imdb_data, mapping=aes(x=votes))+
  geom_histogram(color="yellow")

log_votes_plot <- ggplot(data=imdb_data, mapping=aes(x=log(votes)))+
  geom_histogram(color="yellow")

rating_plot <- ggplot(data=imdb_data, mapping=aes(x=rating))+
  geom_histogram(color="skyblue")

grid.arrange(year_plot,budget_plot,votes_plot, log_votes_plot,
             length_plot,rating_plot, ncol=2)
```

Based on the results above the following transformations are done
```{r}
#Add a new column#
imdb_data <- imdb_data %>%
  mutate(log_votes = log(votes))

#Add a binary variable as a column
imdb_data$rate<- ifelse(imdb_data$rating >= 7, "Greater than Seven", "Less than Seven")
  
```

Scatterplots to understand the relationship of Response variable with numerical explanatory variables
```{r}
s1 <- ggplot(data=imdb_data, aes(x = year, y = rating, color=rate))+
  geom_point()

s2 <- ggplot(data=imdb_data, aes(x = length, y = rating, color=rate))+
  geom_point()

s3 <- ggplot(data=imdb_data, aes(x = budget, y = rating, color=rate))+
  geom_point()

s4 <- ggplot(data=imdb_data, aes(x = log_votes , y = rating, color=rate))+
  geom_point()
grid.arrange(s1, s2, s3, s4, ncol=2)
```

## Boxplots {#sec-box}

Length
```{r}
#| label: fig-plot2
#| fig-cap: boxplot of length(ln)
#| fig-width: 4
#| fig-height: 5
#| fig-align: center
#| message: false

#boxplot
ggplot(data = imdb_data, aes(x = rate, y = length,fill=rate) )+
  geom_boxplot() +
  labs(x = "rating", y = "length")
  
length_outliers <- imdb_data %>%
  group_by(rate) %>%
  mutate(is_outlier = length > quantile(length, 0.75) + 1.5 * IQR(length) |
           length < quantile(length, 0.25) - 1.5 * IQR(length)) %>%
  filter(is_outlier) %>%
  ungroup() # 97 outliers
```

@fig-plot2 shows that the median film log_length of high rating films is less than that of low rating films. Interquartile Range of low rating is smaller than that of high rating, which shows that the data about low rating is more concentrated.

Budget
```{r}
#| label: fig-plot3
#| fig-cap: boxplot of budget
#| fig-width: 4
#| fig-height: 5
#| fig-align: center
#| message: false
#boxplot
ggplot(data = imdb_data, aes(x = rate, y = budget,fill=rate) )+
  geom_boxplot() +
  labs(x = "rating", y = "budget")
budget_outliers <- imdb_data %>%
group_by(rate) %>%
  mutate(is_outlier = budget > quantile(budget, 0.75) + 1.5 * IQR(budget) |
           budget < quantile(budget, 0.25) - 1.5 * IQR(budget)) %>%
  filter(is_outlier) %>%
  ungroup() #9 outliers
  
```

@fig-plot3 shows that the median budget film of high rating films is higher than that of low rating films.

votes

```{r}
#| label: fig-plot4
#| fig-cap: boxplot of log_votes
#| fig-width: 4
#| fig-height: 5
#| fig-align: center
#| message: false
#boxplot
ggplot(data = imdb_data, aes(x = rate, y = log_votes,fill=rate) )+
  geom_boxplot() +
  labs(x = "rating", y = "log_votes")
log_votes_outliers <- imdb_data %>%
  group_by(rate) %>%
  mutate(is_outlier = log_votes > quantile(log_votes, 0.75) + 1.5 * IQR(log_votes) |
           log_votes < quantile(log_votes, 0.25) - 1.5 * IQR(log_votes)) %>%
  filter(is_outlier) %>%
  ungroup()
```

@fig-plot4 shows that the median log_votes film of high rating films is lower than that of low rating films.

genre

```{r}
#| label: fig-plot5
#| fig-cap: Boxplot of genre
#| fig-width: 4
#| fig-height: 5
#| fig-align: center
#| message: false
ggplot(imdb_data, aes(x = genre, y = rating, fill = genre))+
  geom_boxplot()
```

```{r}

```


>>>>>>> Stashed changes

# Formal Data Analysis {#sec-FDA}

# Conclusions {#sec-Conc}
